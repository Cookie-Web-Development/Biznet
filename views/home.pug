doctype html
html(lang=lang)
    head
        meta(charset="UTF-8")
        meta(http-equiv="X-UA-Compatible", content="IE=edge")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        link(rel="shortcut icon", href="/public/img/logo/icon.ico", type="image/x-icon")
        link(rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.2/css/all.css")
        link(rel="stylesheet", href="/public/css/index.css")
        script(src="/public/js/scripts.js" defer) 
        title BizNet Technology
    body
        header.header
            section.header_top
                svg(viewBox="0 0 444 121" fill="none" xmlns="http://www.w3.org/2000/svg" class='logo_svg')
                    g(class="logo_main")
                        path(fill-rule="evenodd" clip-rule="evenodd" d="M46.5 44H79C89 45.8333 106.3 55.1 95.5 77.5C104.5 86.5 114.7 107.3 83.5 118.5H46.5V44ZM62.5 58.5V72.5H79C87 66.5 82.3333 60.6667 79 58.5H62.5ZM62.5 104.5V87.5H82.5C94.1 93.9 87.3333 101.5 82.5 104.5H62.5Z")
                        path(fill-rule="evenodd" clip-rule="evenodd" d="M3.5 115.5H1V119.5H44.5V115.5H42.5V36L28.5 30.5V16.5L26.5 14.5V29.5L21 27V5.5L18 1.5V26L3.5 21V115.5ZM9.5 54V50.5H36.5V54H9.5ZM9.5 86.5V82.5H36.5V86.5H9.5Z")
                        path(d="M122.5 44V118.5H139.5V44H122.5Z")
                        path(d="M159 44V58.5H185.5L156 118.5H208.5V104.5H181.5V103.5L210.5 44.5L159 44Z")
                        path(d="M280.5 86V44.5H297.5V118.5L280.5 105V86Z")
                        path(d="M318.5 44.5V118.5H370.5V104.5H335.5V89.5H364.5V74.5H335.5V58.5H370.5V44.5H318.5Z")
                        path(d="M383.5 44.5V58.5H405.5V118.5H420.5V58.5H443.5V44.5H383.5Z")
                    path(class="logo_sub" d="M227 119.5V45H230L297.5 101V119.5L244 77.5V119.5H227Z")
                    g(class="logo_white")
                        path(d="M10 46.5V42H36.5V46.5H10Z")
                        path(d="M10 62.5V58.5H36.5V62.5H10Z")
                        path(d="M10 71.5V67H36.5V71.5H10Z")
                        path(d="M10 80V75.5H36.5V80H10Z")
                        path(d="M10 103.5V99H36.5V103.5H10Z")
                        path(d="M10 111V107.5H36.5V111H10Z") 
                form(class='searchbar', action='')
                    input(type='text', placeholder=langData.header.search_bar[lang] autocomplete="off")
                    button(type='submit') 
                        i(class="fa-solid fa-magnifying-glass")
                form(class='lang_selector', action='/lang_change', method='get')
                    button(class='button btn_inline')=lang
                div.login
                    button.button.btn_main#login_modal_btn=langData.header.login.login_upper[lang]
            nav.header_bot
                ul.navbar
                    li=langData.header.navbar.home[lang]
                    li 
                        a(href='/catalog')=langData.header.navbar.catalog[lang]
                    li=langData.header.navbar.deals[lang]
        dialog(id='login_modal')
            span.login_text=langData.header.login.login_lower[lang]
            form(action="" id='login_form')
                label(for="username")=langData.header   .login.username[lang]
                input(class='input_box' id='username' type='text' autocomplete="off")
                label(for='password')=langData.header.login.password[lang] 
                div(class='input_div password')
                    input(id='password' type='password' autocomplete="off")
                    label(class='show_password' for='show_password_checkbox')
                        input(type='checkbox' id='show_password_checkbox' checked=false autocomplete="off")
                        i(id='show_password_off' class="fa-solid fa-eye-slash fa-lg show_password_icon active")
                        i(id='show_password_on' class="fa-sharp fa-solid fa-eye fa-lg show_password_icon")
                button(class='button_forgot_password')=langData.header.login.password_forgot[lang]
                button(class='button btn_modal' type='submit')=langData.header.login.login_lower[lang] 
                button(class='button btn_modal')=langData.header.login.sign_up[lang] 
                button(class='button btn_modal login_modal_close')=langData.header.login.cancel[lang]
            button(class='button_modal_close login_modal_close') 
                i(class="fa-solid fa-circle-xmark fa-xl")
        main 
            if (featured_list.length > 0)
                h2=langData.main.best_seller[lang]
                if (featured_list.length == 1)
                    section#product_carousel
                        article(data-product-card='medium' data-carousel class='current')
                            div.image_container
                                    img(src='/public/img/products-images/' + featured_list[0].images[0])
                            div.text_container   
                                p.text_container_header #{featured_list[0].category[lang]} / #{featured_list[0].brand}
                                h3=featured_list[0].name[lang]
                                div.product_card_price_tag
                                    p.price_sell=featured_list[0].format_price_discounted
                                    if(featured_list[0].discount_percent > 0)
                                        p.price_discount
                                            span.price_before #{featured_list[0].format_price} 
                                            span.discount_percent #{Math.round(featured_list[0].discount_percent * 100)}%
                                p.product_card_description=featured_list[0].description[lang]
                                ul.product_card_tags
                                    each tag in featured_list[0].tags[lang]
                                        li=tag 
                else
                    section#product_carousel
                        each item in featured_list  
                            article(data-product-card='medium' data-carousel)
                                div.image_container
                                    img(src='/public/img/products-images/' + item.images[0])
                                div.text_container   
                                    p.text_container_header #{item.category[lang]} / #{item.brand}
                                    h3=item.name[lang]
                                    div.product_card_price_tag
                                        p.price_sell=item.format_price_discounted
                                        if(item.discount_percent > 0)
                                            p.price_discount
                                                span.price_before #{item.format_price} 
                                                span.discount_percent #{Math.round(item.discount_percent * 100)}%
                                    p.product_card_description=item.description[lang]
                                    ul.product_card_tags
                                        each tag in item.tags[lang]
                                            li=tag 
                        div(id='carousel_next' class='carousel_btn')
                            i(class="fa-solid fa-chevron-right fa-xl")
                        div(id='carousel_prev' class='carousel_btn')
                            i(class="fa-solid fa-chevron-left fa-xl")
                        div#carousel_dot_container
                            each item in featured_list 
                                div.carousel_dot
            if (discount_list.length > 0)
                hr.section_divider
                h2=langData.main.deals_day[lang]
                section#product_search_section
                    div#product_result_container
                        each item in discount_list
                            article(data-product-card='small')
                                div.image_container
                                        img(src='/public/img/products-images/' + item.images[0])
                                div.text_container   
                                    p.text_container_header #{item.category[lang]} / #{item.brand}
                                    h3=item.name[lang]
                                    div.product_card_price_tag
                                        p.price_sell=item.format_price_discounted
                                        if(item.discount_percent > 0)
                                            p.price_discount
                                                span.price_before #{item.format_price} 
                                                span.discount_percent #{Math.round(item.discount_percent * 100)}%
                                    p.product_card_description=item.description[lang]
                                    ul.product_card_tags
                                        each tag in item.tags[lang]
                                            li=tag 
        footer

        script.
            /*###########
            Carousel Code
            #############*/
            let carouselCards = document.querySelectorAll('[data-carousel]');
            if (carouselCards.length > 1) { 
                let carousel_next = document.getElementById('carousel_next');
                let carousel_prev = document.getElementById('carousel_prev');
                let carousel_dot = document.querySelectorAll('.carousel_dot');

                let cardIndex = 0;
                carouselCurrent(cardIndex);
                
                carousel_next.addEventListener('click', () => {
                    let newIndex = cardIndex + 1;
                    if (newIndex >= carouselCards.length) {
                        newIndex = 0
                    };

                    carouselAnimToggle(carouselCards, cardIndex, newIndex, 'anim_to_left');
                    
                    cardIndex = newIndex;
                    carouselCurrent(cardIndex);
                });

                carousel_prev.addEventListener('click', () => {
                    let newIndex = cardIndex - 1;
                    if (newIndex < 0) {
                        newIndex = carouselCards.length - 1
                    }

                    carouselAnimToggle(carouselCards, cardIndex, newIndex, 'anim_to_right');

                    cardIndex = newIndex;
                    carouselCurrent(cardIndex);
                })

                //Carousel dots
                let dotArr = Array.from(carousel_dot);

                carousel_dot.forEach(dot => {
                    let dotIndex = dotArr.indexOf(dot);

                    dot.addEventListener('click', () => {
                        carouselAnimToggle(carouselCards, cardIndex, dotIndex, 'anim_to_top');
                        cardIndex = dotIndex;
                        carouselCurrent(cardIndex);
                    })
                });

                // FUNCTIONS
                function carouselCurrent(index) {
                    carouselCards.forEach(card => {
                        card.classList.remove('current');
                        card.classList.remove('next');
                    });

                    carousel_dot.forEach(dot => {
                        dot.classList.remove('current')
                    })
                    carouselCards[index].classList.add('current');
                    carousel_dot[index].classList.add('current')
                };

                function carouselAnimToggle(arr, index, new_index, animation_name) {
                    if (document.getElementsByClassName('animation')) {
                        arr.forEach(card => {
                            card.classList.remove('animation')
                        })};

                    arr.forEach(card => {
                        card.classList.remove('anim_to_left');
                        card.classList.remove('anim_to_right');
                        card.classList.remove('anim_to_top');
                    })
                    
                    arr[new_index].classList.add('next');
                    arr[index].classList.add(animation_name);
                    arr[index].classList.add('animation');
                    arr[index].addEventListener('animationend', () => {
                        arr[index].classList.remove('animation');
                    })
                };
            };
